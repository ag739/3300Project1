<!-- Kelly O'Shaughessy kao58,
	-->
<!DOCTYPE html>
<html>
<head>
	<link href='https://fonts.googleapis.com/css?family=Raleway:400,700italic' rel='stylesheet' type='text/css'>

	<!-- Load the d3 library. -->
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<script src="http://d3js.org/topojson.v1.min.js"></script>
	<script src="http://d3js.org/colorbrewer.v1.min.js"></script>
	<script src="legend.js"></script>
	<script src="data/condensed_food_intake_by_country.js"></script>
	<script>

		var colors = ["rgb(255, 153, 153)", "rgb(255, 204, 153)", "rgb(255, 255, 153)", "rgb(179, 255, 153)", "rgb(153, 255, 230)"];

		var countries = [];
		data.forEach(function(obj) {
			countries.push(obj.Country);
		});

		/*Creating x & y scale functions that map data to SVG coordinates*/
		var xscale = d3.scale.ordinal()
					.domain(countries)
						.rangePoints([125, 850]);
		var yscale = d3.scale.linear().domain([0, 3000]).range([450, 50]);

		function createLegend(svg, legendData) {
			sampleOrdinal = d3.scale.ordinal().domain(legendData)
							.range(["#ff9999","#ffcc99","#ffff99","#b3ff99","#99ffe6"]);
			legendGraph = d3.svg.legend().labelFormat("none")
					.cellPadding(5)
					.orientation("vertical")
					.units("Ingredient")
					.cellWidth(25)
					.cellHeight(18)
					.inputScale(sampleOrdinal)
					.cellStepping(10);
			svg.append("g").attr("transform", "translate(820,50)")
							.attr("class", "legend")
							.call(legendGraph);
		}

		function createGraph(divID, legendData, titleColor) {
			var height = 650, width = 1000;
			
			//Container
			var svg_container = d3.select("#" + divID).append("svg")
							.attr("width", width + 350)
							.attr("height", height);
							// .style("border", " 1px solid #ccc");
			/*Add d3 axes */
			var xaxis = d3.svg.axis().scale(xscale)
						.orient("bottom")
						//.ticks(0)
						.tickSize(2,2);
			var yaxis = d3.svg.axis().scale(yscale)
						.orient("left")
						.ticks(10)
						.tickSize(2,2);
			//adding & transforming scales
			svg_container.append("g")
					.attr("transform", "translate(0,500)")
					.attr("class", "axis")
					.attr("fill", titleColor)
					.call(xaxis)
					.selectAll("text")
						.style("text-anchor","end")
						.style("font-size","10.5")
						.attr("dx","-.8em")
						.attr("dy",".15em")
						.attr("transform","rotate(-65)");
			svg_container.append("g")
						.attr("transform", "translate(125,52)")
						.attr("class", "axis")
						.attr("fill", titleColor)
						.call(yaxis);

			// food pyramid img
			var img = svg_container.append("svg:image")
						.attr("xlink:href", "img/" + divID.toLowerCase() + ".png")
					    .attr("width", 300)
					    .attr("height", 232)
					    .attr("x", 875)
					    .attr("y",height/2 - 232/2);

			//Labels
			svg_container.append("text")
							.attr("x", 450).attr("y",620)
							.style("text-anchor", "middle")
							.text("Country")
							.style("font-size",14);
			svg_container.append("text")
							.attr("x", -300).attr("y",40)
							.style("text-anchor", "middle")
							.text("Intake (kcal/day)")
							.attr("transform", "rotate(-90)")
							.style("font-size", 14);
			svg_container.append("text")
							.attr("x", 450).attr("y",30)
							.style("text-anchor", "middle")
							.text(divID)
							.style("font-size", 25)
							.style("fill",titleColor);

			createLegend(svg_container, legendData);
			return svg_container;
		}
	</script>
	<title>INFO 3300 Project 1</title>
	<style>
		body { font-family: 'Raleway', sans-serif; }
		svg { font-weight: bold; font-family: 'Raleway', sans-serif;}
		div {border-top: 3px solid gray; padding-top:20px;}	
		a, a:link, a:visited {color: #80c1ff; text-decoration: none}
		.axis text {fill: black;}
	</style>

</head>
<body>

	<h1>Food Intake by Country</h1>
	<p>Ever wonder how food intake, based on what our "daily recommended values", relate to average BMI?
		We're looking at countries' food intake, based on the daily recommended values for each food group, to see if there's a relationship between that and BMI.
		Although the food pyramid was discontinued in 2011, the data we gathered is from 2010, so we figured it is an okay way to represent our data.
		<br>Food pyramid image found <a href="https://en.wikipedia.org/wiki/MyPyramid" target="_blank">here</a>.</p>
	<div id = "Grains">
		<script>
		var svg_grains = createGraph("Grains", ["Wheat","Carbs"], "#ff794d");
		data.forEach(function(obj) {
			svg_grains.append("rect").attr("x", xscale(obj.Country)).attr("y", yscale(obj.Carbohydrates)).attr("width", 15).attr("height", yscale(0) - yscale(obj.Carbohydrates) + 50).style("fill", colors[1]);
			svg_grains.append("rect").attr("x", xscale(obj.Country)).attr("y", yscale(obj.Wheat)).attr("width", 15).attr("height", yscale(0) - yscale(obj.Wheat) + 50).style("fill", colors[0]);
		});
		</script>
	</div>

	<div id = "Vegetables">
		<script> 
		var svg_veggies = createGraph("Vegetables", ["Vegetables"],"#009926");
		data.forEach(function(obj) {
			svg_veggies.append("rect").attr("x", xscale(obj.Country)).attr("y", yscale(obj.Vegetables)).attr("width", 15).attr("height", yscale(0) - yscale(obj.Vegetables) + 50).style("fill", colors[0]);
		});
		</script>
	</div>

	<div id = "Fruits">
		<script> 
		var svg_fruits = createGraph("Fruits", ["Fruit"],"#cc0000");
		data.forEach(function(obj){
			svg_fruits.append("rect").attr("x", xscale(obj.Country)).attr("y", yscale(obj.Fruit)).attr("width", 15).attr("height", yscale(0) - yscale(obj.Fruit) + 50).style("fill", colors[0]);
		});
		</script>
	</div>

	<div id = "Oils">
		<script> 
		var svg_oils = createGraph("Oils", ["Sugars", "Olive Oil", "Palm Oil", "Soybean Oil", "Vegetable Oil"],"#cccc00");
		data.forEach(function(obj){
			svg_oils.append("rect").attr("x", xscale(obj.Country)).attr("y", yscale(obj.Sugars)).attr("width", 5).attr("height", yscale(0) - yscale(obj.Sugars) + 50).style("fill", colors[0]);
			svg_oils.append("rect").attr("x", xscale(obj.Country)+5).attr("y", yscale(obj.Olive_Oil)).attr("width", 5).attr("height", yscale(0) - yscale(obj.Olive_Oil) + 50).style("fill", colors[1]);
			svg_oils.append("rect").attr("x", xscale(obj.Country)+10).attr("y", yscale(obj.Palm_Oil)).attr("width", 5).attr("height", yscale(0) - yscale(obj.Palm_Oil) + 50).style("fill", colors[2]);
			svg_oils.append("rect").attr("x", xscale(obj.Country)+15).attr("y", yscale(obj.Soybean_Oil)).attr("width", 5).attr("height", yscale(0) - yscale(obj.Soybean_Oil) + 50).style("fill", colors[3]);
			svg_oils.append("rect").attr("x", xscale(obj.Country)+20).attr("y", yscale(obj.Vegetable_Oil)).attr("width", 5).attr("height", yscale(0) - yscale(obj.Vegetable_Oil) + 50).style("fill", colors[4]);
		});
		</script>
	</div>

	<div id = "Milk">
		<script> 
		var svg_milk = createGraph("Milk", ["Milk"],"#00ace6");
		data.forEach(function(obj){
			svg_milk.append("rect").attr("x", xscale(obj.Country)).attr("y", yscale(obj.Milk)).attr("width", 15).attr("height", yscale(0) - yscale(obj.Milk) + 50).style("fill", colors[0]);
		});
		</script>
	</div>

	<div id = "Meat">
		<script> 
		var svg_meat = createGraph("Meat", ["Meat", "Eggs", "Nuts", "Fish"],"#6600cc");
		data.forEach(function(obj){
			svg_meat.append("rect").attr("x", xscale(obj.Country)).attr("y", yscale(obj.Meat)).attr("width", 5).attr("height", yscale(0) - yscale(obj.Meat) + 50).style("fill", colors[0]);
			svg_meat.append("rect").attr("x", xscale(obj.Country)+5).attr("y", yscale(obj.Eggs)).attr("width", 5).attr("height", yscale(0) - yscale(obj.Eggs) + 50).style("fill", colors[1]);
			svg_meat.append("rect").attr("x", xscale(obj.Country)+10).attr("y", yscale(obj.Nuts)).attr("width", 5).attr("height", yscale(0) - yscale(obj.Nuts) + 50).style("fill", colors[2]);
			svg_meat.append("rect").attr("x", xscale(obj.Country)+15).attr("y", yscale(obj.Fish)).attr("width", 5).attr("height", yscale(0) - yscale(obj.Fish) + 50).style("fill", colors[3]);
		});
		</script>
	</div>

	<div id = "BMI">
		<!-- MAP -->
	</div>
</body>
</html>